¡AJÁ! **Ese es el problema principal**. 

Cuando usas un **slicer/filtro de `Periodo_numerico`** directamente, estás filtrando TODA la tabla KRIS, por eso la medida no puede "ver" el periodo anterior.

---

## El Problema

Cuando seleccionas `Periodo_numerico = 202508` en un slicer:

1. **Toda la tabla KRIS se filtra** a solo las filas con 202508
2. Tu medida intenta buscar 202507, pero **ese periodo ya no está visible** por el filtro
3. Por eso sale en blanco o 1

---

## Solución: Crear una Tabla Calendario (Dimensión de Periodo)

Necesitas una **tabla separada de periodos** para el filtro, y relacionarla con KRIS.

### **Paso 1: Crear Tabla de Periodos**

```DAX
Periodos = 
VAR MinPeriodo = MIN(KRIS[Periodo_numerico])
VAR MaxPeriodo = MAX(KRIS[Periodo_numerico])

RETURN
ADDCOLUMNS(
    FILTER(
        GENERATESERIES(MinPeriodo, MaxPeriodo),
        MOD([Value], 100) >= 1 && MOD([Value], 100) <= 12  // Solo meses válidos
    ),
    "Periodo", [Value],
    "Año", INT([Value] / 100),
    "Mes", MOD([Value], 100),
    "Año-Mes", FORMAT([Value], "0000-00"),
    "Mes Nombre", 
        SWITCH(
            MOD([Value], 100),
            1, "Ene", 2, "Feb", 3, "Mar", 4, "Abr",
            5, "May", 6, "Jun", 7, "Jul", 8, "Ago",
            9, "Sep", 10, "Oct", 11, "Nov", 12, "Dic",
            "?"
        )
)
```

### **Paso 2: Crear Relación**

En el modelo de datos:
```
Periodos[Periodo]  ──(1)──►──(*)──  KRIS[Periodo_numerico]
```

Arrastra `Periodos[Periodo]` hacia `KRIS[Periodo_numerico]` para crear la relación.

### **Paso 3: Usar el Slicer con la Tabla Periodos**

**IMPORTANTE:** 
- ❌ No uses `KRIS[Periodo_numerico]` en el slicer
- ✅ Usa `Periodos[Periodo]` o `Periodos[Año-Mes]` en el slicer

---

## Medidas Corregidas (usando tabla Periodos)

```DAX
KIRS_detection_rate_MesAnterior = 
VAR PeriodoSeleccionado = SELECTEDVALUE(Periodos[Periodo])
VAR PeriodoAnterior = 
    IF(
        NOT(ISBLANK(PeriodoSeleccionado)),
        IF(
            MOD(PeriodoSeleccionado, 100) = 1,
            (INT(PeriodoSeleccionado / 100) - 1) * 100 + 12,
            PeriodoSeleccionado - 1
        ),
        BLANK()
    )

VAR Detectada_Anterior = 
    CALCULATE(
        [item_detectada_por_alerta],
        Periodos[Periodo] = PeriodoAnterior
    )

VAR Autorizada_Anterior = 
    CALCULATE(
        [item_autorizada_rechazada],
        Periodos[Periodo] = PeriodoAnterior
    )

RETURN
DIVIDE(Detectada_Anterior, Autorizada_Anterior, 0)
```

```DAX
KIRS_detection_rate_AñoAnterior = 
VAR PeriodoSeleccionado = SELECTEDVALUE(Periodos[Periodo])
VAR PeriodoAA = PeriodoSeleccionado - 100

VAR Detectada_AA = 
    CALCULATE(
        [item_detectada_por_alerta],
        Periodos[Periodo] = PeriodoAA
    )

VAR Autorizada_AA = 
    CALCULATE(
        [item_autorizada_rechazada],
        Periodos[Periodo] = PeriodoAA
    )

RETURN
DIVIDE(Detectada_AA, Autorizada_AA, 0)
```

---

## Alternativa: Si NO quieres crear tabla Periodos

Si prefieres seguir usando el filtro directo en `KRIS[Periodo_numerico]`, entonces usa `ALLSELECTED` y `TREATAS`:

```DAX
KIRS_detection_rate_MesAnterior_SinTabla = 
VAR TodosPeriodos = 
    CALCULATETABLE(
        VALUES(KRIS[Periodo_numerico]),
        ALLSELECTED(KRIS)
    )

VAR PeriodoActual = MAX(KRIS[Periodo_numerico])

VAR PeriodoAnterior = 
    IF(
        MOD(PeriodoActual, 100) = 1,
        (INT(PeriodoActual / 100) - 1) * 100 + 12,
        PeriodoActual - 1
    )

VAR ExistePeriodoAnterior = 
    COUNTROWS(
        FILTER(TodosPeriodos, [Periodo_numerico] = PeriodoAnterior)
    ) > 0

VAR Detectada = 
    CALCULATE(
        [item_detectada_por_alerta],
        ALLSELECTED(KRIS),
        KRIS[Periodo_numerico] = PeriodoAnterior
    )

VAR Autorizada = 
    CALCULATE(
        [item_autorizada_rechazada],
        ALLSELECTED(KRIS),
        KRIS[Periodo_numerico] = PeriodoAnterior
    )

RETURN
IF(ExistePeriodoAnterior, DIVIDE(Detectada, Autorizada, 0), BLANK())
```

---

## Resumen

**El problema:** Filtrar directamente por `KRIS[Periodo_numerico]` oculta los demás periodos.

**La solución ideal:** 
1. Crear tabla `Periodos` 
2. Relacionarla con `KRIS`
3. Usar `Periodos[Periodo]` en los slicers
4. Las medidas funcionarán correctamente

**La solución alternativa:** 
Usar `ALLSELECTED()` en las medidas, pero es más complejo y propenso a errores.

---

¿Qué prefieres hacer?
- **A)** Crear la tabla Periodos (recomendado)
- **B)** Intentar con ALLSELECTED sin crear tabla adicional

🎯