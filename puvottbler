library(pivottabler)

# Crear la tabla dinámica usando qhpvt
tablal <- qhpvt(
  data = data_con_marcas,
  rows = c("Authentication_Type", "Authentication_Status", "Marked_As"),
  calculations = list(
    "Numero_Tarjetas" = c("n_distinct(PAN)", "Nº Tarjetas Únicas"),
    "Numero_Transacciones" = c("n()", "Nº Transacciones"),
    "Monto_Dolares" = c("sum(Purchase_Amount_USD, na.rm = TRUE)", "Total USD")
  )
)

# Mostrar la tabla
print(tablal)